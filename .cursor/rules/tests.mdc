---
description: Instructions to run the Yarn integration tests
globs: 
alwaysApply: false
---
To run integration tests from Yarn:

1. First build the application *in release mode*:

```
cargo build -r
```

2. Run integration tests from the Berry repository:

```
./yarn.sh berry test:integration <jest patterns>
```

Some important tips:

- Running all tests is wasteful. Only run the tests relevant to the feature you're implementing (first by testsuite jest pattern, then potentially further by test name using the `-t` flag).

- You're allowed to call `ls -lRa` on the "Temporary fixture folder" listed in the failed tests. This should allow you to check what exactly got generated (please try to use `-R` whenever possible to minimize the amount of `ls` we need to run).

- Prefix the test command by JEST_LOG_SPAWNS=1 to set an environment variable that will log the output every single Yarn call. This is only useful if you're sure you run a single tests, as otherwise the outputs will be interlaced and hard to read.

- You can read the implementation of the tests by using `curl https://raw.githubusercontent.com/yarnpkg/berry/refs/heads/master/packages/acceptance-tests/pkg-tests-specs/sources/[...]`. This might help you understand what is being tested exactly.
