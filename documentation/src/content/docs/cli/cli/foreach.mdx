---
title: "yarn workspaces foreach"
description: "run a command on all workspaces"
slug: "cli/foreach"
category: "cli"
---

import { Code } from "@astrojs/starlight/components";

<div className="subtitle">
run a command on all workspaces

</div>

## Usage
<Code code="yarn workspaces foreach <commandName> ..." lang="bash" />

## Examples
<p>Publish all packages
:</p>
<Code code="yarn workspaces foreach -A --no-private npm publish --tolerate-republish" lang="bash" />

<p>Run the build script on all descendant packages
:</p>
<Code code="yarn workspaces foreach -A run build" lang="bash" />

<p>Run the build script on current and all descendant packages in parallel, building package dependencies first
:</p>
<Code code="yarn workspaces foreach -Apt run build" lang="bash" />

<p>Run the build script on several packages and all their dependencies, building dependencies first
:</p>
<Code code="yarn workspaces foreach -Rpt --from '{workspace-a,workspace-b}' run build" lang="bash" />

## Details
This command will run a given sub-command on current and all its descendant 
workspaces. Various flags can alter the exact behavior of the command:

- If `-p,--parallel` is set, the commands will be ran in parallel; they'll by 
default be limited to a number of parallel tasks roughly equal to half your 
core number, but that can be overridden via `-j,--jobs`, or disabled by 
setting `-j unlimited`.

- If `-p,--parallel` and `-i,--interlaced` are both set, Yarn will print the 
lines from the output as it receives them. If `-i,--interlaced` wasn't set, it 
would instead buffer the output from each process and print the resulting 
buffers only after their source processes have exited.

- If `-t,--topological` is set, Yarn will only run the command after all 
workspaces that it depends on through the `dependencies` field have 
successfully finished executing. If `--topological-dev` is set, both the 
`dependencies` and `devDependencies` fields will be considered when figuring 
out the wait points.

- If `-A,--all` is set, Yarn will run the command on all the workspaces of a 
project.

- If `-R,--recursive` is set, Yarn will find workspaces to run the command on by 
recursively evaluating `dependencies` and `devDependencies` fields, instead of 
looking at the `workspaces` fields.

- If `-W,--worktree` is set, Yarn will find workspaces to run the command on by 
looking at the current worktree.

- If `--from` is set, Yarn will use the packages matching the 'from' glob as the 
starting point for any recursive search.

- If `--since` is set, Yarn will only run the command on workspaces that have 
been modified since the specified ref. By default Yarn will use the refs 
specified by the `changesetBaseRefs` configuration option.

- If `--dry-run` is set, Yarn will explain what it would do without actually 
doing anything.

- The command may apply to only some workspaces through the use of `--include` 
which acts as a whitelist. The `--exclude` flag will do the opposite and will 
be a list of packages that mustn't execute the script. Both flags accept glob 
patterns (if valid Idents and supported by 
[micromatch](https://github.com/micromatch/micromatch)). Make sure to escape 
the patterns, to prevent your own shell from trying to expand them. You can 
also use the `--no-private` flag to avoid running the command in private 
workspaces.

The `-v,--verbose` flag can be passed up to twice: once to prefix output lines 
with the originating workspace's name, and again to include start/finish/timing 
log lines. Maximum verbosity is enabled by default in terminal environments.

If the command is `run` and the script being run does not exist the child 
workspace will be skipped without error.

## Options
| Definition | Description |
| ---------- | ----------- |
| <h4 id="options-from%20%230" className="header-code"><code className="language-text">--from #0</code></h4> | An array of glob pattern idents or paths from which to base any recursion |
| <h4 id="options-A%2C-all" className="header-code"><code className="language-text">-A,--all</code></h4> | Run the command on all workspaces of a project |
| <h4 id="options-R%2C-recursive" className="header-code"><code className="language-text">-R,--recursive</code></h4> | Run the command on the current workspace and all of its recursive dependencies |
| <h4 id="options-W%2C-worktree" className="header-code"><code className="language-text">-W,--worktree</code></h4> | Run the command on all workspaces of the current worktree |
| <h4 id="options-v%2C-verbose" className="header-code"><code className="language-text">-v,--verbose</code></h4> | Increase level of logging verbosity up to 2 times |
| <h4 id="options-p%2C-parallel" className="header-code"><code className="language-text">-p,--parallel</code></h4> | Run the commands in parallel |
| <h4 id="options-i%2C-interlaced" className="header-code"><code className="language-text">-i,--interlaced</code></h4> | Print the output of commands in real-time instead of buffering it |
| <h4 id="options-j%2C-jobs%20%230" className="header-code"><code className="language-text">-j,--jobs #0</code></h4> | The maximum number of parallel tasks that the execution will be limited to; or `unlimited` |
| <h4 id="options-t%2C-topological" className="header-code"><code className="language-text">-t,--topological</code></h4> | Run the command after all workspaces it depends on (regular) have finished |
| <h4 id="options-topological-dev" className="header-code"><code className="language-text">--topological-dev</code></h4> | Run the command after all workspaces it depends on (regular + dev) have finished |
| <h4 id="options-include%20%230" className="header-code"><code className="language-text">--include #0</code></h4> | An array of glob pattern idents or paths; only matching workspaces will be traversed |
| <h4 id="options-exclude%20%230" className="header-code"><code className="language-text">--exclude #0</code></h4> | An array of glob pattern idents or paths; matching workspaces won't be traversed |
| <h4 id="options-no-private" className="header-code"><code className="language-text">--no-private</code></h4> | Avoid running the command on private workspaces |
| <h4 id="options-since" className="header-code"><code className="language-text">--since</code></h4> | Only include workspaces that have been changed since the specified ref. |
| <h4 id="options-n%2C-dry-run" className="header-code"><code className="language-text">-n,--dry-run</code></h4> | Print the commands that would be run, without actually running them |